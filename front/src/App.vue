<script setup lang="ts">
import { onBeforeUnmount, onMounted } from "vue";
import { useHead } from '@unhead/vue'

import AudioPlayer from "./components/audio/AudioPlayer.vue";
import { usePlayerStore } from "./stores/player";

useHead({
  title: 'Beatly',
  meta: [
    {
      name: 'description',
      content: 'Beatly - Plateforme gratuite d\'Ã©coute et de partage de musique. DÃ©couvrez de nouveaux artistes, crÃ©ez vos playlists et partagez vos morceaux prÃ©fÃ©rÃ©s.',
    },
    {
      name: 'keywords',
      content: 'beatly, musique gratuite, streaming musical, plateforme musicale, Ã©coute musique en ligne, partage musique, playlist gratuite, dÃ©couverte musicale, artistes Ã©mergents, crÃ©ation musicale, communautÃ© musicale, musique indie, musique pop, musique rock, musique Ã©lectronique, musique hip-hop, musique jazz, musique classique, musique du monde, musique alternative, musique acoustique, musique instrumentale, musique pour se dÃ©tendre, musique pour travailler, musique pour Ã©tudier, musique pour faire du sport',
    },
    {
      property: 'og:title',
      content: 'Beatly - Votre plateforme musicale gratuite pour dÃ©couvrir et partager de la musique',
    },
    {
      property: 'og:description',
      content: 'Rejoignez Beatly, la communautÃ© musicale gratuite oÃ¹ vous pouvez Ã©couter des milliers de morceaux, dÃ©couvrir des artistes Ã©mergents et partager vos crÃ©ations musicales.',
    },
    {
      property: 'og:image',
      content: 'https://beatly.com/banner.png',
    },
    {
      name: 'twitter:title',
      content: 'Beatly ðŸŽµ Musique gratuite, partage et dÃ©couverte',
    },
    {
      name: 'twitter:description',
      content: 'ðŸŽ§ Plateforme musicale 100% gratuite | ðŸš€ DÃ©couvrez de nouveaux talents | ðŸ“± CrÃ©ez et partagez vos playlists',
    },
    {
      name: 'twitter:image',
      content: 'https://beatly.com/banner.png',
    },
    {
      name: 'twitter:card',
      content: 'summary_large_image',
    },
  ]
})

const playerStore = usePlayerStore();
const handleBeforeUnload = () => {
  playerStore.clearQueue();
};

onMounted(() => {
  window.addEventListener("beforeunload", handleBeforeUnload);
});

onBeforeUnmount(() => {
  window.removeEventListener("beforeunload", handleBeforeUnload);
});
</script>

<template>
  <AudioPlayer />

  <router-view />
</template>
